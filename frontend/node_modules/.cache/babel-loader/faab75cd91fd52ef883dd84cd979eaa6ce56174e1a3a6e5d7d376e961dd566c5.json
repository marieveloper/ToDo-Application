{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n// import configuration with API url; @ refers to the src directory\nimport config from \"@/config\";\n// import library for HTTP requests\nimport axios from \"axios\";\n// import JS method to use in this view\nimport { showToastMessage } from \"../js/util\";\nimport { fetchAllAssignees, assigneeSelectTableFields } from \"../js/assignee-rest-client\";\nimport { fetchToDoById } from \"@/js/toDo-rest-client\";\nexport default {\n  name: \"ToDoDetails\",\n  data() {\n    return {\n      toDoToUpdate: {\n        id: \"\",\n        title: \"\",\n        description: \"\",\n        finished: \"\",\n        assigneeIdList: [],\n        assigneeList: [],\n        dueDate: \"\"\n      },\n      assignees: [],\n      assigneeIds: [],\n      fields: [],\n      items: [],\n      selected: [],\n      show: false\n    };\n  },\n  computed: {\n    selectedRows() {\n      return this.items.filter(item => item.selected);\n    }\n  },\n  methods: {\n    //selects or deselects a row\n    rowClicked(item) {\n      if (item.selected) {\n        this.$set(item, 'selected', false);\n      } else {\n        this.$set(item, 'selected', true);\n      }\n    },\n    // send GET request to API to fetch all assignees\n    fetchAllAssignees: async function (todo) {\n      this.items = await fetchAllAssignees();\n      for (const element of this.items) {\n        for (const assignee of this.assignees) {\n          if (element.id === assignee.id) {\n            this.$set(element, 'selected', true);\n          }\n        }\n      }\n      this.toDoToUpdate = todo;\n      this.show = true;\n    },\n    //updates the assigneeList of the todo\n    onSubmitAssignees: function (todo) {\n      this.assigneeIds = [];\n      this.selectedRows.forEach(assignee => this.assigneeIds.push(JSON.stringify(assignee.id)));\n      todo.assigneeIdList = this.assigneeIds;\n      this.assignees = this.selectedRows;\n      this.show = false;\n    },\n    // executed on form submit\n    onSubmit: function (event) {\n      event.preventDefault();\n      axios.put(`${config.apiBaseUrl}/todos/${this.toDoToUpdate.id}`, this.toDoToUpdate).then(response => {\n        showToastMessage(this, \"Alert\", `Successfully updated assignee with ID \n                    ${response.data.id}!`, \"success\");\n        this.$router.push(\"/todos\");\n      }).catch(error => {\n        const errObject = error.response.data.errors[0];\n        showToastMessage(this, \"Alert\", `Error: ${errObject.field} ${errObject.defaultMessage}!`, \"danger\");\n      });\n    }\n  },\n  // executed after the component has been started\n  created: async function () {\n    this.toDoToUpdate = await fetchToDoById(this.$route.params.id);\n    this.toDoToUpdate.assigneeList.forEach(assignee => this.assigneeIds.push(JSON.stringify(assignee.id)));\n    this.toDoToUpdate.assigneeIdList = this.assigneeIds;\n    this.toDoToUpdate.dueDate = new Date(this.toDoToUpdate.dueDate);\n    this.assignees = this.toDoToUpdate.assigneeList;\n    this.fields = assigneeSelectTableFields();\n  }\n};","map":{"version":3,"mappings":";AA4EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;EACAA;EACAC;IACA;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACA;IACA;EACA;EACAC;IACA;IACAC;MACA;QACA;MACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;QACA;UACA;YACA;UACA;QACA;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA,0BACAC;MACAC;MACA;MACA;IACA;IACA;IACAC;MACAC;MACAC,MACAC,6EACAC;QACAC;AACA;QACA;MACA,GACAC;QACA;QACAD,0FACA;MACA;IACA;EACA;EACA;EACAE;IACA;IACA,uCACAT;IACA;IACA;IACA;IACA;EACA;AACA","names":["name","data","toDoToUpdate","id","title","description","finished","assigneeIdList","assigneeList","dueDate","assignees","assigneeIds","fields","items","selected","show","computed","selectedRows","methods","rowClicked","fetchAllAssignees","onSubmitAssignees","assignee","todo","onSubmit","event","axios","put","then","showToastMessage","catch","created"],"sourceRoot":"src/views","sources":["ToDo-details.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <div>\r\n            <b-card>\r\n                <b-card-header>\r\n                    <b-form-group>\r\n                        <b-button style=\"float:right\" size=\"sm\" clas=\"mb-0\" href=\"#/todos/\">\r\n                            <b-icon icon=\"x-lg\"></b-icon>\r\n                        </b-button>\r\n                        <h1>ToDo Details: {{ toDoToUpdate.title }}</h1>\r\n                    </b-form-group>\r\n                </b-card-header>\r\n                <b-form @submit=\"onSubmit\">\r\n                    <b-form-group label=\"Title:\" class=\"mt-1\">\r\n                        <b-form-input v-model=\"toDoToUpdate.title\" type=\"text\" required></b-form-input>\r\n                    </b-form-group>\r\n                    <b-form-group label=\"Description:\">\r\n                        <b-form-input v-model=\"toDoToUpdate.description\" type=\"text\" required></b-form-input>\r\n                    </b-form-group>\r\n                    <b-form-group>\r\n                        <b-form-checkbox v-model=\"toDoToUpdate.finished\" type=\"boolean\" class=\"m-1\"> Finished\r\n                        </b-form-checkbox>\r\n                    </b-form-group>\r\n                    <b-form-group>\r\n                        <b-form-row>\r\n                            <template>\r\n                                <div class=\"assignees\" v-for=\"assignee in assignees\"\r\n                                     v-bind:key=\"assignee.id\">\r\n                                    <router-link :to=\"'/assignees/' + assignee.id\">\r\n                                    <b-badge pill variant=\"light\" class=\"text-wrap m-1\" size=\"l\"\r\n                                             style=\"font-size: medium;font-weight: normal;\">\r\n                                        {{ assignee.name }}, {{ assignee.prename }}\r\n                                    </b-badge></router-link>\r\n                                </div>\r\n                            </template>\r\n                        </b-form-row>\r\n                        <b-btn class=\"m-1\" pill variant=\"outline-secondary\" @click=\"fetchAllAssignees(toDoToUpdate)\">\r\n                            Update Assignees\r\n                            <b-icon icon=\"person-plus\"></b-icon>\r\n                        </b-btn>\r\n                    </b-form-group>\r\n                    <b-form-group label=\"Due Date\">\r\n                        <b-form-datepicker id=\"example-datepicker\" v-model=\"toDoToUpdate.dueDate\"\r\n                                           class=\"mb-2\"></b-form-datepicker>\r\n                    </b-form-group>\r\n                    <b-button pill type=\"submit\" variant=\"outline-primary\" class=\"m-1\">Submit</b-button>\r\n                    <b-button pill variant=\"outline-danger\" class=\"m-1\" href=\"#/todos/\">Cancel</b-button>\r\n                </b-form>\r\n            </b-card>\r\n        </div>\r\n        <b-modal v-model=\"show\" ref=\"modal\" title=\"Update Assignees\" hide-footer size=\"lg\">\r\n            <div>\r\n                <div>\r\n                    <b-form @submit=\"onSubmitAssignees(toDoToUpdate)\">\r\n                        <b-table noCollapse hover responsive :items=\"items\" :fields=\"fields\" @row-clicked=\"rowClicked\">\r\n                            <template v-slot:cell(selected)=\"{ item, field: { key } }\">\r\n                                <b-checkbox v-model=\"item[key]\" type=\"boolean\"></b-checkbox>\r\n                            </template>\r\n                        </b-table>\r\n                        <div class=\"w-100\">\r\n                            <b-button pill variant=\"outline-danger\" class=\"float-right m-1\" @click=\"show = false\">\r\n                                Cancel\r\n                            </b-button>\r\n                            <b-button pill variant=\"outline-primary\" class=\"float-right m-1\"\r\n                                      @click=\"onSubmitAssignees(toDoToUpdate)\">\r\n                                Submit\r\n                            </b-button>\r\n                        </div>\r\n                    </b-form>\r\n                </div>\r\n            </div>\r\n        </b-modal>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n// import configuration with API url; @ refers to the src directory\r\nimport config from \"@/config\";\r\n// import library for HTTP requests\r\nimport axios from \"axios\";\r\n// import JS method to use in this view\r\nimport {showToastMessage} from \"../js/util\";\r\nimport {fetchAllAssignees, assigneeSelectTableFields} from \"../js/assignee-rest-client\";\r\nimport {fetchToDoById} from \"@/js/toDo-rest-client\";\r\n\r\nexport default {\r\n    name: \"ToDoDetails\",\r\n    data() {\r\n        return {\r\n            toDoToUpdate: {\r\n                id: \"\",\r\n                title: \"\",\r\n                description: \"\",\r\n                finished: \"\",\r\n                assigneeIdList: [],\r\n                assigneeList: [],\r\n                dueDate: \"\"\r\n            },\r\n            assignees: [],\r\n            assigneeIds: [],\r\n            fields: [],\r\n            items: [],\r\n            selected: [],\r\n            show: false\r\n        };\r\n    },\r\n    computed: {\r\n        selectedRows() {\r\n            return this.items.filter(item => item.selected)\r\n        }\r\n    },\r\n    methods: {\r\n        //selects or deselects a row\r\n        rowClicked(item) {\r\n            if (item.selected) {\r\n                this.$set(item, 'selected', false)\r\n            } else {\r\n                this.$set(item, 'selected', true)\r\n            }\r\n        },\r\n        // send GET request to API to fetch all assignees\r\n        fetchAllAssignees: async function (todo) {\r\n            this.items = await fetchAllAssignees();\r\n            for (const element of this.items) {\r\n                for (const assignee of this.assignees) {\r\n                    if (element.id === assignee.id) {\r\n                        this.$set(element, 'selected', true);\r\n                    }\r\n                }\r\n            }\r\n            this.toDoToUpdate = todo;\r\n            this.show = true;\r\n        },\r\n        //updates the assigneeList of the todo\r\n        onSubmitAssignees: function (todo) {\r\n            this.assigneeIds = [];\r\n            this.selectedRows.forEach(\r\n                assignee => this.assigneeIds.push(JSON.stringify(assignee.id)));\r\n            todo.assigneeIdList = this.assigneeIds;\r\n            this.assignees = this.selectedRows;\r\n            this.show = false;\r\n        },\r\n        // executed on form submit\r\n        onSubmit: function (event) {\r\n            event.preventDefault();\r\n            axios\r\n                .put(`${config.apiBaseUrl}/todos/${this.toDoToUpdate.id}`, this.toDoToUpdate)\r\n                .then((response) => {\r\n                    showToastMessage(this, \"Alert\", `Successfully updated assignee with ID \r\n                    ${response.data.id}!`, \"success\");\r\n                    this.$router.push(\"/todos\");\r\n                })\r\n                .catch((error) => {\r\n                    const errObject = error.response.data.errors[0];\r\n                    showToastMessage(this, \"Alert\", `Error: ${errObject.field} ${errObject.defaultMessage}!`, \r\n                        \"danger\");\r\n                });\r\n        }\r\n    },\r\n    // executed after the component has been started\r\n    created: async function () {\r\n        this.toDoToUpdate = await fetchToDoById(this.$route.params.id);\r\n        this.toDoToUpdate.assigneeList.forEach(\r\n            assignee => this.assigneeIds.push(JSON.stringify(assignee.id)));\r\n        this.toDoToUpdate.assigneeIdList = this.assigneeIds;\r\n        this.toDoToUpdate.dueDate = new Date(this.toDoToUpdate.dueDate);\r\n        this.assignees = this.toDoToUpdate.assigneeList;\r\n        this.fields = assigneeSelectTableFields();\r\n    }\r\n};\r\n</script>\r\n<style>\r\n@import '../assets/stylesheet.css';\r\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}